<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="google-site-verification" content="vy14mO9wf2bjKiZs8BIxCFXKJDP40DqGTqiwxscMctw" />
<title>Sử dụng dịch vụ $resource xây dựng ứng dụng CRUD trong AngularJS &#8211; THAPSANG.NET</title>
<meta name="description" content="Dịch vụ $resource trong AngularJS.">
<meta name="keywords" content="RESTful, $resource, angularjs">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/my-candle.png">
<meta name="twitter:title" content="Sử dụng dịch vụ $resource xây dựng ứng dụng CRUD trong AngularJS">
<meta name="twitter:description" content="Dịch vụ $resource trong AngularJS.">
<meta name="twitter:creator" content="@taly2808">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Sử dụng dịch vụ $resource xây dựng ứng dụng CRUD trong AngularJS">
<meta property="og:description" content="Dịch vụ $resource trong AngularJS.">
<meta property="og:url" content="/angularjs/su-dung-$resource-xay-dung-crud-app-trong-angularjs">
<meta property="og:site_name" content="THAPSANG.NET">
<meta property="og:image" content="/images/my-candle.png">





<link rel="canonical" href="/angularjs/su-dung-$resource-xay-dung-crud-app-trong-angularjs">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="THAPSANG.NET Feed">
<link rel="author" href="https://plus.google.com/+TaLy2808?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search...">
        <i class="icon-remove-sign"></i>
        <ul class="search-results post-list"></ul><!-- /.search-results -->
    </div><!-- /.search-form -->
</div><!-- ./search-wrapper -->




<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  
<div id="fade"></div>
<a id="slide" class="animated fade"></a>
<aside id="sidebar">
    <nav id="navigation">
    <h2>MENU</h2>
    <hr>

            <li>
                    <a href="/">Trang bìa</a>
                 </li>

            <li>
                    <a href="/categories">Danh mục</a>
                 </li>

            <li>
                    <a href="/tags"><i class="icon-tag"></i> Tags</a>
                 </li>

            <li>
                    <a href="/about">Giới thiệu</a>
                 </li>
            
           <li><a href="https://feedburner.google.com/fb/a/mailverify?uri=thapsangnet/taly2808&amp;loc=en_US" title="Atom/RSS feed" target="_blank"><i class="icon-rss"></i> Feed</a></li>
    </nav>
    
    
</aside>

<header id="masthead" class="blog-background overlay align-center align-middle animated from-bottom"  style="background-image: url(/images/picture-2.jpg)" itemscope itemtype="http://schema.org/Organization">


    <button class="menu-button animated fade dosearch">
        <i class="icon-search"></i>
    </button>


    <div class="inner">
        <div class="container">
            <a class="brand" href="/" role="banner" itemprop="url">

                <img itemprop="logo" src="/images/my-candle.png" alt="THAPSANG.NET Logo" />

            <h1 class="blog-title light" itemprop="name">
                THAPSANG.NET
            </h1>
                
            </a>
        </div>
    </div>
    
    
    <div class="decor-wrapper">
        <svg id="header-decor" class="decor bottom" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
            <path class="large left" d="M0 0 L50 50 L0 100" fill="rgba(255,255,255, .1)"></path>
            <path class="large right" d="M100 0 L50 50 L100 100" fill="rgba(255,255,255, .1)"></path>

            <path class="medium left" d="M0 100 L50 50 L0 33.3" fill="rgba(255,255,255, .3)"></path>
            <path class="medium right" d="M100 100 L50 50 L100 33.3" fill="rgba(255,255,255, .3)"></path>

            <path class="small left" d="M0 100 L50 50 L0 66.6" fill="rgba(255,255,255, .5)"></path>
            <path class="small right" d="M100 100 L50 50 L100 66.6" fill="rgba(255,255,255, .5)"></path>

            <path d="M0 99.9 L50 49.9 L100 99.9 L0 99.9" fill="rgba(255,255,255, 1)"></path>

            <path d="M48 52 L50 49 L52 52 L48 52" fill="rgba(255,255,255, 1)"></path>

        </svg>
    </div>
    
</header>

<div id="main" class="content" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
    <div class="container">
        <div class="row">
            <article class="post col-md-10 col-md-offset-1 hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
            
            
            
            
            
                    <header class="post-header entry-header">
                    
                        
                        <h1 class="post-title text-center hyper lighter bordered-bottom entry-title" itemprop="headline">Sử dụng dịch vụ $resource xây dựng ứng dụng CRUD trong AngularJS</h1>
                        
                        <div class="cursive" style="color: #000; font-style:italic;">Dịch vụ $resource trong AngularJS.</div>
                        <div class="post-info text-center small">
                            <span class="entry-date date published"><time datetime="2014-12-05T00:00:00+07:00" class="post-time" itemprop="datePublished">05 Dec 2014</time><span>
                            in <span class="post-tags"><a href="/categories/index.html#angularjs" data-toggle="tooltip" title="Other posts from the Angularjs category" rel="tag">Angularjs</a></span>&nbsp;<span class="post-tags"><i class="icon-time"></i>&nbsp;<span class="time">23.61</span> minutes read</span>
                        </div>
                    </header>
                    <div class="post-body bordered-bottom" itemprop="description">
                        
                        <p>Các ứng dụng sử dụng web service ngày càng phổ biến. AngularJS cung cấp dịch vụ $resource hỗ trợ tương tác với dịch vụ RESTful một cách dễ dàng. Trong bài viết này, chúng ta sẽ tìm hiểu cách thức sử dụng $resource trong ứng dụng web xây dựng bằng AngularJS.</p>

<section>
  <header>
    <h2>Nội dung</h2>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#http-vs-resource">$http vs $resource</a></li>
  <li><a href="#s-dng-resource">Sử dụng $resource</a></li>
  <li><a href="#cc-thc-resource-lm-vic">Các thức $resource làm việc</a>    <ul>
      <li><a href="#to-mt-resource">Tạo một Resource</a></li>
      <li><a href="#i-tng-tr-li-ca-hm-resource">Đối tượng trả lại của hàm $resource</a>        <ul>
          <li><a href="#default-actions">Default actions</a></li>
          <li><a href="#cc-action-method-ca-resource-class-v-resource-instance">Các action method của Resource Class và Resource Instance</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#unit-testing">Unit testing</a></li>
  <li><a href="#p-dng-vo-v-d-c-th">Áp dụng vào ví dụ cụ thể</a>    <ul>
      <li><a href="#xy-dng-restful-service">Xây dựng RESTful service</a></li>
      <li><a href="#xy-dng-ng-dng-pha-client-bng-angularjs">Xây dựng ứng dụng phía client bằng AngularJS</a></li>
    </ul>
  </li>
  <li><a href="#ti-liu-tham-kho">Tài liệu tham khảo</a></li>
</ul>

  </div>
</section>

<h2 id="http-vs-resource">$http vs $resource</h2>

<p>Cả $http và $resource đều có thể làm việc tốt với REST. Vậy lý do là gì để chúng ta sử dụng $resource thay vì sử dụng $http? Sau khi google và theo quan điểm cá nhân thì dưới đây là các lý do được đưa ra:</p>

<ul>
  <li>$resource viết ít code hơn.</li>
  <li>$resource cho phép chúng ta định nghĩa URL dưới dạng các template string (một chuỗi có chứa phần giữ chỗ (placeholder), ví dụ: /api/books/:id) với giá trị các tham số. $resource sẽ thay thế các placeholder bằng các giá trị tham số của các đối tượng cụ thể. </li>
  <li>Việc xây dựng các service với $resource linh hoạt hơn với việc thiết lập các custom action cho các đối tượng cụ thể và có thể sử dụng nó linh hoạt trong bất kỳ controller bạn muốn.</li>
  <li>$resource cho phép tạo ra một đối tượng javascript đại diện cho data model riêng biệt. Bằng cách này, với mỗi hoạt động được tính toán trên đối tượng được tạo ra thông qua $resource sẽ được thực hiện ở phía server. Ví dụ, nếu bạn muốn thực hiện update một book với $http, trước hết bạn phải lấy được đối tượng đó, sau đó thực hiện gán giá trị cho các thuộc tính rồi thực hiện save với đối tượng book đi kèm:</li>
</ul>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://yourserver/api/books/&#39;</span> <span class="o">+</span> <span class="mi">3</span><span class="p">).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">book</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">book</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;My name updated&quot;</span>
	<span class="nx">$http</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;http://yourserver/api/books/&#39;</span><span class="p">,</span> <span class="nx">book</span><span class="p">);</span>
<span class="p">});</span></code></pre></div>

<p>Với $resource, chúng ta gọi hàm $update() trên mỗi phần tử book:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">BookService</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">3</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">book</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">book</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;My name edited&quot;</span><span class="p">;</span>
	<span class="nx">book</span><span class="p">.</span><span class="nx">$update</span><span class="p">();</span>
<span class="p">});</span></code></pre></div>

<h2 id="s-dng-resource">Sử dụng $resource</h2>

<p>AngularJS cung cấp dịch vụ $resource thông qua module <a href="https://docs.angularjs.org/api/ngResource">ngResource</a> riêng biệt. Do đó, để có thể sử dụng dịch vụ này, bạn cần:</p>

<ul>
  <li>download file <a href="https://code.angularjs.org/1.3.2/angular-resource.js">angular-resource.js</a> và include nó vào trang HTML. </li>
</ul>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;angular.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;angular-resource.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<ul>
  <li>Thêm nữa, trong module ứng dụng chính, bạn cần khai báo phụ thuộc vào module <code>ngResource</code>:</li>
</ul>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ngResource&#39;</span><span class="p">]);</span></code></pre></div>

<ul>
  <li>Bơm (inject) $resource vào bất kỳ đâu (service, controller, …) bạn muốn sử dụng nó.</li>
</ul>

<h2 id="cc-thc-resource-lm-vic">Các thức $resource làm việc</h2>

<p>$resource làm việc với RESTful backend, do đó chúng ta cần có REST endpoint theo định dạng sau:</p>

<figure>
	<img src="/assets/img/REST-endpoints.png" />
</figure>

<h3 id="to-mt-resource">Tạo một Resource</h3>

<p>Chúng ta có thể tạo một Resource bằng Resource factory: <strong>$resource(url, paramDefaults, actions, options)</strong></p>
<figure>
	<img src="/assets/img/create-a-resource.png" />
</figure>

<p>Các tham số trong Resource factory:</p>

<ul>
  <li><strong>url</strong> - <em>{string}</em> - là địa chỉ REST endpoint, đây là một URL template được tham số hóa với các tham số được bắt đầu với dấu <code>:</code>, chẳng hạn như <code>/books/:bookId</code>.</li>
  <li><strong>paramDefaults</strong> - <em>{Object}</em> - giả sử url template có dạng <em>/books/:bookId</em> và tham số <em>{bookId: ‘12’, author: ‘Fukuzawa’}</em> thì kết quả hiển thị trên URL là <em>/books/12?author=Fukuzawa</em>.	Nếu giá trị của tham số có tiền tố <code>@</code>, ví dụ <em>{bookId: ‘@id’}</em> thì việc đặt tham số <code>bookId</code> thành <code>@id</code> có nghĩa là bất cứ khi nào chúng ta gọi phương thức <code>$update()</code> và <code>$delete()</code> trên một resource instance thì giá trị của <code>:bookId</code> sẽ được thiết lập thành thuộc tính <code>id</code> của resource instance. Cách sử dụng này rất hữu ích cho các PUT request và DELETE request.</li>
  <li>
    <p><strong>actions</strong> - <em>{Object}</em> - mặc định lời gọi hàm $resource trả về một <strong>resource class</strong> với 5 phương thức mặc định gồm <strong>get(), query(), save(), remove(), delete()</strong> (xem <a href="#i-tng-tr-li-ca-hm-resource">Đối tượng trả lại của hàm $resource</a>). Tham số này cho phép chúng ta thêm các phuơng thức tùy chỉnh (custom method) vào resource constructor (hay resource class) với cú pháp: <code>{ action: {method:?, params:?, isArray:?, headers:?, ...} };</code>. Trong đó:</p>

    <ul>
      <li>action - <em>{string}</em> - tên của action.</li>
      <li>method - <em>{string}</em> - phương thức HTTP, ví như GET, POST, PUT, DELETE, JSONP, PATCH, …</li>
      <li>params - <em>{Object}</em> - tập các tùy chọn của các tham số trước khi thực hiện action này.</li>
      <li>isArray - <em>{boolean}</em> - quy định dữ liệu trả về cho phương thức này là Array hay Object.</li>
      <li>Ngoài ra nó còn chứa đầy đủ các thuộc tính của <a href="https://docs.angularjs.org/api/ng/service/$http#usage">$http.config</a> như <code>headers</code>, <code>transformRequest</code>, <code>transformResponse</code>, <code>cache</code>, <code>timeout</code>, <code>withCredentials</code>,<code>responseType</code>, <code>interceptor</code>. Bạn có thể xem lại bài viết <a href="/angularjs/hieu-ve-$http-service-trong-angularjs">tìm hiểu về $http</a> để nắm rõ cách thức sử dụng các thuộc tính đó.</li>
    </ul>
  </li>
  <li><strong>options</strong> - <em>{Object}</em> - tham số này hiện tại chỉ hỗ trợ thiết lập thuộc tính <code>stripTrailingSlashes</code>. Mặc định, thuộc tính này được thiết lập giá trị <code>true</code>, nghĩa là dấu <code>/</code> trong URL sẽ bị bỏ qua khi truyền qua hàm <code>$resource()</code>, chúng ta có thể hủy bỏ tính năng này bằng cách thiết lập <em>{ stripTrailingSlashes: false }</em>. Ví dụ: </li>
</ul>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ngResource&#39;</span><span class="p">]).</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;Book&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$resource&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$resource</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;http://yourserver/books/:bookId&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">bookId</span><span class="o">:</span> <span class="s1">&#39;@id&#39;</span><span class="p">},{</span> 
    <span class="nx">update</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="p">{</span>
  	<span class="nx">stripTrailingSlashes</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">});</span>
<span class="p">}]);</span></code></pre></div>

<h3 id="i-tng-tr-li-ca-hm-resource">Đối tượng trả lại của hàm $resource</h3>

<h4 id="default-actions">Default actions</h4>

<p>Hàm Resource factory $resource() trả lại một <strong>resource class</strong> (hay Resource constructor) với 5 phương thức mặc định là:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span> <span class="s1">&#39;get&#39;</span><span class="o">:</span>  <span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">},</span>
<span class="s1">&#39;save&#39;</span><span class="o">:</span>   <span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">},</span>
<span class="s1">&#39;query&#39;</span><span class="o">:</span>  <span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">isArray</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span>
<span class="s1">&#39;remove&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s1">&#39;DELETE&#39;</span><span class="p">},</span>
<span class="s1">&#39;delete&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s1">&#39;DELETE&#39;</span><span class="p">}</span> <span class="p">};</span></code></pre></div>

<hr />

<p>Hãy xem chúng ta sử dụng hàm <code>get()</code>, <code>query()</code>, <code>save()</code> như thế nào trong controller:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,[</span><span class="s1">&#39;ngResource&#39;</span><span class="p">]);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;Book&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$resource</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;http://yourserver/api/books/:id&#39;</span><span class="p">);</span>
<span class="p">});</span>
 
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;ResourceController&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">Book</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">book</span> <span class="o">=</span> <span class="nx">Book</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">id</span> <span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">book</span><span class="p">);</span>
  <span class="p">});</span> <span class="c1">// get() trả lại một book duy nhất</span>
 
  <span class="kd">var</span> <span class="nx">books</span> <span class="o">=</span> <span class="nx">Book</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">books</span><span class="p">);</span>
  <span class="p">});</span> <span class="c1">//query() trả về tất cả các books</span>
 
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">book</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class="p">();</span> <span class="c1">//tạo mới một resource instance</span>
 
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">book</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="s1">&#39;some data&#39;</span><span class="p">;</span>
 
  <span class="nx">Book</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">book</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//dữ liệu đã được thêm mới, bạn có thể làm gì đó ở đây</span>
  <span class="p">});</span> <span class="c1">//thêm mới một book. Giả sử rằng $scope.book là một đối tượng Book</span>
<span class="p">});</span></code></pre></div>

<p><code>get()</code> function trong kịch bản trên liên quan đến một GET request <code>/api/books/:id</code>. Tham số <code>:id</code> trong URL sẽ được thay thế với <code>$scope.id</code>. Tham số thứ 2 của function <code>get()</code> là hàm success callback, nó được thực thi khi dữ liệu từ server trả về thành công. Cần lưu ý rằng, function <code>get()</code> trả lại một đối tượng rỗng (empty object) và đối tượng này sẽ được tự động gắn dữ liệu khi có dữ liệu thật từ server trả về. Đây là một thủ thuật hữu ích vì thường các tài nguyên được gán vào model và sau đó sẽ được render bởi view, do đó bạn có thể thiết lập đối tượng rỗng đó vào trong $scope và hướng nó vào trong view. Khi dữ liệu thực tế đến và đối tượng đã được thiết lập sẵn trong view, dữ liệu được gắn kết vào các vị trí tương ứng và view cũng được cập nhật. Điều này có nghĩa là trong hầu hết các trường hợp, chúng ta không phải viết một hàm callback cho các action method này.</p>

<p>Function <code>query()</code> liên quan đến GET request <code>/api/books</code> (không có tham số :id) và trả lại một mảng rỗng. Khi dữ liệu từ server đến, mảng này đã có sẵn ở đó. Một lần nữa bạn có thể thiết lập mảng này vào trong $scope model và đề cập đến nó trong view sử dụng <code>ng-repeat</code>.</p>

<p><code>save()</code> function liên quan đến POST request <code>/api/books</code> với tham số thứ nhất là POST body. Tham số thứ hai là hàm callback sẽ được gọi khi dữ liệu được lưu trữ thành công. <code>$resource()</code> function trả lại một resource class và lời gọi <code>new Book()</code> sẽ tạo ta một đối tượng cụ thể (resource instance), thiết lập các thuộc tính cho nó và lưu trữ đối tượng vào backend.</p>
<hr />

<h4 id="cc-action-method-ca-resource-class-v-resource-instance">Các action method của Resource Class và Resource Instance</h4>

<p>Các action method này dự kiến có 4 tham số, bao gồm: <strong>params</strong> object, <strong>data</strong> object, <strong>success</strong> function, <strong>error</strong> function.</p>

<ul>
  <li>HTTP GET action của Resource Class: <code>Resource.action(paramsObj, successFn, errorFn)</code>. Ví dụ:
    <ul>
      <li>Book.get(paramsObj, successFn, errorFn);</li>
      <li>Book.query(paramsObj, successFn, errorFn);</li>
    </ul>
  </li>
  <li>non-GET action của Resource Class: <code>Resource.action(paramsObj, dataObj, successFn, errorFn)</code>. Ví dụ:
    <ul>
      <li>Book.save(paramsObj, dataObj, successFn, errorFn);</li>
      <li>Book.remove(paramsObj, dataObj, successFn, errorFn);</li>
      <li>Book.delete(paramsObj, dataObj, successFn, errorFn);</li>
    </ul>
  </li>
  <li>non-GET action của Resource Instance: <code>instance.$action(paramsObj, successFn, errorFn)</code>. Ví dụ:
    <ul>
      <li>book.$save(paramsObj, successFn, errorFn);</li>
      <li>book.$remove(paramsObj, successFn, errorFn);</li>
      <li>book.$delete(paramsObj, successFn, errorFn);</li>
    </ul>
  </li>
</ul>

<p>Lưu ý rằng, các non-GET action method của resource instance bắt đầu với dấu <code>$</code>. Và cả class action và instance action có các chức năng tương đương:</p>
<figure>
		<img src="/assets/img/instance-vs-constructor-action-methods.png" />
	</figure>

<p>Hàm <strong>success callback</strong> được gọi với tham số <em>(value, responseHeaders)</em>. Hàm <strong>error callback</strong> được gọi với tham số <em>(httpResponse)</em></p>

<p><strong>Class actions</strong> trả lại một <strong>empty instance</strong>. <strong>Instance actions</strong> trả lại <strong>lời hứa (promise)</strong> của action.</p>

<p>Ngoài ra, các Resource instance và collection có thêm các thuộc tính: </p>

<ul>
  <li><code>$promise</code>: việc thực hiện các request thông qua web service thường trả lại dữ liệu với độ trễ nhất định. Để đảm bảo dữ liệu đã sẵn sàng trước khi gán nó vào model hoặc render lên view, chúng ta có thể sử dụng <a href="https://docs.angularjs.org/api/ng/service/$q">promise</a>. Ví dụ:</li>
</ul>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;/api/todó/:id&#39;</span><span class="p">);</span>

<span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">}).</span><span class="nx">$promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// success</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">todos</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">errResponse</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// fail</span>
<span class="p">});</span>

<span class="nx">Todo</span><span class="p">.</span><span class="nx">query</span><span class="p">().</span><span class="nx">$promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todos</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// success</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">todos</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">errResponse</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// fail</span>
<span class="p">});</span></code></pre></div>

<p>Và cần nhớ rằng, thuộc tính <code>$promise</code> là một thuộc tính trên cùng giá trị được trả về ở trên, do đó ta có thể sử dụng với cách khác như sau:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;/api/todos/:id&#39;</span><span class="p">);</span>

<span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">}).</span><span class="nx">$promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="nx">todo</span><span class="p">;</span>
<span class="p">});</span>
<span class="c1">//tương đương với cách viết sau:</span>
<span class="kd">var</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="nx">todo</span><span class="p">;</span>
<span class="p">});</span>
<span class="c1">//----------------</span>
<span class="kd">var</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">});</span>
<span class="nx">todo</span><span class="p">.</span><span class="nx">$promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="nx">todo</span><span class="p">;</span>
<span class="p">});</span>
<span class="c1">//tương đương với cách viết sau:</span>
<span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="mi">123</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="nx">todo</span><span class="p">;</span>
<span class="p">});</span></code></pre></div>

<ul>
  <li><code>$resolved</code>: ban đầu thuộc tính này có giá trị <code>false</code>, sau khi tương tác với server lần đầu tiên hoàn thành (dù success hay fail) nó được thiết lập giá trị <code>true</code>. Thuộc tính này hữu ích trong việc biết Resource đã được resolved hay chưa để thực hiện gắn kết dữ liệu (data-binding).</li>
</ul>

<h2 id="unit-testing">Unit testing</h2>

<p>$resource được thực hiện ở tầng cao hơn $http. Nó tương tác với backend thông qua các HTTP request. Bạn có thể sử dụng <a href="https://docs.angularjs.org/api/ngMock/service/$httpBackend">$httpBackend mock</a> để thực hiện unit test cho $resource.</p>

<h2 id="p-dng-vo-v-d-c-th">Áp dụng vào ví dụ cụ thể</h2>

<p>Trong ví dụ này, chúng ta sẽ xây dựng một ứng dụng CRUD (Create - Read - Update - Delete) Book sử dụng $resource trong AngularJS. Ví dụ được xây dựng trên Ubuntu nên việc cài đặt các công cụ sẽ được hướng dẫn trên Ubuntu. Với các hệ điều hành khác, bạn vui lòng xem hướng dẫn trong các link đính kèm công cụ.</p>

<h3 id="xy-dng-restful-service">Xây dựng RESTful service</h3>

<p>Trong ví dụ này, chúng ta cần tạo ra một dịch vụ web RESTful phía backend có thể trả về với các request tương ứng. Bạn có thể sử dụng bất cứ công cụ nào miễn sao có thể tạo ra RESTful resource để demo. Ở đây, tôi sử dụng <a href="http://deployd.com/">deployd</a> - một công cụ giúp xây dựng các API đơn giản. </p>

<p>Để sử dụng công cụ này, bạn cần <a href="http://docs.deployd.com/docs/getting-started/installing-deployd.html">cài đặt deployd</a> và <a href="http://docs.mongodb.org/manual/installation/">mongodb</a>.</p>

<p>Bạn chạy lệnh sau để cài đặt deployd: </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>npm install deployd -g</code></pre></div>

<p>Sau đó, chạy lệnh <code>dpd -V</code> để kiểm tra phiên bản của deployd. Nếu bạn thấy phiên bản của deployd ví như <code>0.7.0</code> tức là bạn đã cài đặt thành công deployd.</p>

<p>Tiếp đến, bạn cần cài đặt mongodb nếu chưa có:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>sudo apt-get install -y mongodb-org</code></pre></div>

<p>Bạn kiểm tra phiên bản mongodb bằng lệnh <code>mongod --version</code>.</p>

<p>Tiếp đó, bạn có thể tải <a href="https://github.com/taly2808/example-angularjs-book-ws/archive/master.zip">ví dụ cho phần Book web service</a> theo địa chỉ cho <a href="https://github.com/taly2808/example-angularjs-book-ws.git">git clone</a>. Sau đó bạn di chuyển vào thư mục ứng dụng, tiếp đó chạy lệnh <code>dpd -d</code> để chạy ứng dụng và mở dashboard của ứng dụng trên trình duyệt</p>

<figure>
	<img src="/assets/img/dpd-d-cli.png" />
</figure>

<p>Khi đó, ứng dụng sẽ được mở trên trình duyệt với cổng mặc định là 2403 như hình dưới đây:</p>

<figure>
	<img src="/assets/img/example-book-ws-first.png" />
</figure>

<p>Với ví dụ đơn giản này, chúng ta tạo ra một Books Collection với các thuộc tính gồm: id, title, category, price. Bạn có thể dễ dàng thêm các bản ghi cho Books Collection. Giả sử tôi thêm 3 bản ghi, khi đó ứng dụng sẽ như sau:</p>

<figure>
	<img src="/assets/img/example-book-ws-data.png" />
</figure>

<p>Chuyển sang tab API, chúng ta sẽ thấy danh sách các API mà ứng dụng cung cấp:</p>

<figure>
	<img src="/assets/img/example-book-ws-api.png" />
</figure>

<p>Khi chạy ứng dụng phía client, ứng dụng này cần được chạy để cung cấp các REST endpoint và tương tác với client.</p>

<h3 id="xy-dng-ng-dng-pha-client-bng-angularjs">Xây dựng ứng dụng phía client bằng AngularJS</h3>

<p>Bạn có thể tải demo tại địa chỉ <a href="https://github.com/taly2808/example-angularjs-book-client.git">git clone</a>. Trong phần này, chúng ta sẽ sử dụng $resource để thực hiện các thao tác CRUD với Book. Dùng Terminal di chuyển vào thư mục <em>example-angularjs-book-client</em>. Bạn cần cài đặt các gói thư viện cần dùng cho HTTP Server:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>git clone https://github.com/taly2808/example-angularjs-book-client.git
<span class="nv">$ </span><span class="nb">cd </span>example-angularjs-book-client
<span class="nv">$ </span>npm install connect serve-static --save-dev</code></pre></div>

<p>Sau khi <strong>npm</strong> cài đặt xong các gói thư viện trên, chạy HTTP Server bằng lệnh:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>node server</code></pre></div>

<p>Mở cửa sổ trình duyệt mới, nhập vào địa chỉ http://localhost:3000, ta sẽ được giao diện như sau:</p>

<figure>
	<img src="/assets/img/example-book-client-1.png" />
</figure>

<p>Trong phần này, chúng ta tạo ra một service factory <em>Book</em> sử dụng $resource để request đến server và sử dụng nó trong controller để lấy dữ liệu:</p>

<script src="http://gist-it.appspot.com/https://github.com/taly2808/example-angularjs-book-client/blob/master/js/app.js?footer=0">
</script>

<h2 id="ti-liu-tham-kho">Tài liệu tham khảo</h2>

<ol>
  <li><a href="https://docs.angularjs.org/api/ngResource/service/$resource">AngularJS: API: $resource</a></li>
  <li><a href="http://www.sitepoint.com/creating-crud-app-minutes-angulars-resource/">Creating a CRUD App in Minutes with Angular’s $resource</a></li>
</ol>


                        <br>
                    
                    
                    <div class="entry-tags text-center">
                    
                        <i class="icon-tags"></i>&nbsp;Tagged with <a href="/tags/index.html#RESTful" data-toggle="tooltip" title="Posts tagged with RESTful" rel="tag">RESTful</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#$resource" data-toggle="tooltip" title="Posts tagged with $resource" rel="tag">$resource</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#angularjs" data-toggle="tooltip" title="Posts tagged with angularjs" rel="tag">angularjs</a>
                    
                    </div>
                    
                    </div>
        </div>
        <script>
var linkwithin_site_id = 2347195;
</script>
<div class="linkwithin_div"></div>
<script src="http://www.linkwithin.com/widget.js"></script>
<a href="http://www.linkwithin.com/"><img src="http://www.linkwithin.com/pixel.png" alt="Related Posts Plugin for WordPress, Blogger..." style="border: 0" /></a>
                    <footer class="post-footer entry-meta">
                        <div class="post-share text-center">
    <p class="light small">
        Share this post
    </p>
    <ul class="social-mini">
        <li>
            <a href="https://twitter.com/intent/tweet?text=&quot;Sử dụng dịch vụ $resource xây dựng ứng dụng CRUD trong AngularJS&quot;%20/angularjs/su-dung-$resource-xay-dung-crud-app-trong-angularjs%20via%20&#64;taly2808"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" data-toggle="tooltip" title="Share on Twitter" itemprop="Twitter">
                <i class="icon-twitter"></i>
            </a>
        </li>
        <li>
            <a  href="https://www.facebook.com/sharer/sharer.php?u=/angularjs/su-dung-$resource-xay-dung-crud-app-trong-angularjs"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" data-toggle="tooltip" title="Share on Facebook" itemprop="Facebook">
                <i class="icon-facebook"></i>
            </a>
        </li>
        <li>
            <a href="https://plus.google.com/share?url=/angularjs/su-dung-$resource-xay-dung-crud-app-trong-angularjs"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" data-toggle="tooltip" title="Share on Google plus" itemprop="GooglePlus">
                <i class="icon-google-plus"></i>
            </a>
        </li>
    </ul>
</div>
                        <div class="post-author text-center">                       
	        <img src="/images/my-ava.png" alt="Ta Ly's photo" itemprop="image" class="post-avatar img-circle img-responsive"/>    
	    <h4 class="bordered-bottom vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person">Written by <span itemprop="name" class="fn"><a href="/about" rel="author" title="About Ta Ly" itemprop="url">Ta Ly</a></span></h4>
	    <p>Hãy thắp một ngọn nến nhỏ, thay vì nguyền rủa bóng đêm!</p>
</div>
 
                        <div id="disqus_thread"></div><!-- /#disqus_thread -->
                    </footer>
            </article>
    </div>
</div>

<footer id="footer"  class="blog-background overlay text-center align-middle animated from-top" style="background-image: url(/images/picture-2.jpg)" >


    <div class="inner">
        <div class="container">

            <ul class="social-icons">
            <li>
                <a href="http://twitter.com/taly2808" data-toggle="tooltip" title="Ta Ly on Twitter" target="_blank">
                    <i class="icon-twitter"></i>
                </a>
            </li>
            <li>
                <a href="http://facebook.com/taly2808" data-toggle="tooltip" title="Ta Ly on Facebook" target="_blank">
                    <i class="icon-facebook"></i>
                </a>
            </li>
            <li>
                <a href="https://plus.google.com/+TaLy2808" data-toggle="tooltip" title="Ta Ly on Google+" target="_blank">
                    <i class="icon-google-plus"></i>
                </a>
            </li>
            
            <li>
                <a href="taly2808" data-toggle="tooltip" title="Ta Ly on LinkedIn" target="_blank">
                    <i class="icon-linkedin"></i>
                </a>
            </li>
            
            
            <li>
                <a href="http://github.com/taly2808" data-toggle="tooltip" title="Ta Ly on Github" target="_blank">
                    <i class="icon-github"></i>
                </a>
            </li>
        </ul>
            <div>
                Bản quyền nội dung thuộc về <a href="/about/">Ta Ly</a> &copy; 2014 &dash; 2015.
            </div>
            <ul class="menu-items">
            
            <li>
                
                    <a href="/"><i class="icon-home"></i></a>&nbsp;&bull;
                 
            </li>
            
            <li>
                
                    <a href="/categories">Danh mục</a>&nbsp;&bull;
                 
            </li>
            
            <li>
                
                    <a href="/tags"><i class="icon-tag"></i> Tags</a>&nbsp;&bull;
                 
            </li>
            
            <li>
                
                    <a href="/about">Giới thiệu</a>&nbsp;&bull;
                 
            </li>
            
            <li><a href="https://feedburner.google.com/fb/a/mailverify?uri=thapsangnet/taly2808&amp;loc=en_US" title="Atom/RSS feed" target="_blank"><i class="icon-rss"></i> Feed</a></li>
        </ul>
        </div>
    </div>
    
        <div class="decor-wrapper">
            <svg id="footer-decor" class="decor top" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">

                <path class="large left" d="M0 0 L50 50 L0 100" fill="rgba(255,255,255, .1)"></path>
                <path class="large right" d="M100 0 L50 50 L100 100" fill="rgba(255,255,255, .1)"></path>

                <path class="medium left" d="M0 0 L50 50 L0 66.6" fill="rgba(255,255,255, .3)"></path>
                <path class="medium right" d="M100 0 L50 50 L100 66.6" fill="rgba(255,255,255, .3)"></path>

                <path class="small left" d="M0 0 L50 50 L0 33.3" fill="rgba(255,255,255, .5)"></path>
                <path class="small right" d="M100 0 L50 50 L100 33.3" fill="rgba(255,255,255, .5)"></path>

                <path d="M0 0 L50 50 L100 0 L0 0" fill="rgba(255,255,255, 1)"></path>

                <path d="M48 48 L50 51 L52 48 L48 48" fill="rgba(255,255,255, 1)"></path>

            </svg>
        </div>
    
</footer>


    
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<script type="text/javascript" src="/assets/js/waypoints.min.js"></script>
<script type="text/javascript" src="/assets/js/script.js"></script>
<script type='text/javascript'>$(document).ready(function(){$(".time").text(function(a,b){return Math.round(parseFloat(b))})});</script>

<script type="text/javascript">

/*      Slides       */

$("a#slide").click(function(){
    $("#sidebar,body,a#slide,#fade").addClass("slide")
});

$("#fade,#header,#posts-container").click(function(){
    $("#sidebar,body,a#slide,#fade").removeClass("slide")
});

$("a#click-filter").click(function(){
    $("#slide-filter").slideToggle("medium");
    $("#slide-pages").slideOut("medium");
});

$("a#click-pages").click(function(){
    $("#slide-pages").slideToggle("medium");
    $("#slide-filter").slideOut("medium");
});

/*      End-Slides      */

</script>


<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : '/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55360781-1', 'auto');
  ga('send', 'pageview');

</script>


<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'thapsang'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 
</body>
</html>
